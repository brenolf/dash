!function(a){"use strict";a.Dash=function(a,b,c,d){function q(a){if(void 0===a)return p=[],null;p.push(a);var b=p.length,c=f.expected.length;return 0===c?p:b>c?(p.shift(),p):b===c?p:c>b?null:void 0}function r(a){var b={65:0,87:1,68:2,83:3};return a>=37&&40>=a?a-37:void 0!==b[a]?b[a]:-1}function s(){a.dismiss(),a.toc(),clearTimeout(l),n=!1,b.after_game(g)}function t(a){for(var b=["left","up","right","down"],c=0;4>c&&!(a.indexOf(b[c])>=0);c++);u(c+37)}function u(a){return n?(b.key_pressed(a,f.expected.clone(),f.challenges.clone()),m||!o?!1:(e.test(a)===!0?e.correct():e.test(a)===!1&&e.wrong(),void 0)):void 0}if(!a)return!1;var e=this,f=null,g=0,h=3,i=0,j=-1,k=!1,l=null,m=!1,n=!1,o=!1,p=[];e.wrong=function(){return f.toc(),b.lost_life(h-1),a.toc(),a.fails(h),clearTimeout(l),0===--h?s():(e.start(),void 0)},e.correct=function(){f.toc(),g++,b.got_point(g),a.toc(),a.scores(g),g>i&&!k&&(b.best_score(g),k=!0),g===j&&a.hide_timer(),clearTimeout(l),e.start()},e.end=function(){s()},e.is_paused=function(){return m},e.test=function(a){if(a=r(a),-1===a)return null;var b=q(a);return null===b?null:b.compare(f.expected)?!0:!1},e.pause=function(){m=!0,clearTimeout(l),a.toc()},e.resume=function(){m=!1},e.start=function(){if(n&&!m){f.new_round(),q(),o=!1,b.before_game(f.direction,f.challenges);var c=a.get_drop_time();c=f.apply_ratio(c,.9999,a.MIN_DROP_TIME),c+=2+4*(1-f.get_ratio()),a.set_drop_time(Math.round(c)),a.retrieve(f.direction,f.challenges,function(){a.tic(f.press_time),o=!0,f.tic(),clearTimeout(l),l=setTimeout(function(){return f.toc(),f.missable?e.wrong():(p.compare(f.expected)?e.correct():e.wrong(),void 0)},f.press_time),setTimeout(function(){b.on_panel_retrieve(f.direction,f.challenges.clone(),f.expected.clone())},5)})}},e.prepare=function(b,e,l,m){void 0===e&&(e=3),void 0===l&&(l=0),void 0===m&&(m=-1),i=l,j=m,f=new DashLevel(b,c,d),a.prepare(),h=e,g=0,n=!0,k=!1},e.init=function(){var c=["before_game","after_game","best_score","lost_life","got_point","key_pressed"],d=c.length;void 0===b&&(b={});for(var f=0;d>f;f++){var g=c[f];void 0===b[g]&&(b[g]=function(){})}window.addEventListener("focus",function(){e.resume(),e.start();var a=$("title").html();$("title").html(a.replace(" - Paused",""))}),window.addEventListener("blur",function(){e.pause();var a=$("title").html();$("title").html(a+" - Paused")}),$("body").keydown(function(a){var b=a.keyCode;b>=37&&40>=b&&(a.preventDefault(),a.stopPropagation()),u(b)});var h=a.getPanels();d=h.length;for(var f=0;d>f;f++)Hammer(h[f].get(0),{recognizers:[[Hammer.Swipe,{direction:Hammer.DIRECTION_ALL,velocity:.2,threshold:10}]]}).on("swipeleft",function(a){t(a.type)}).on("swipeup",function(a){t(a.type)}).on("swiperight",function(a){t(a.type)}).on("swipedown",function(a){t(a.type)});return e},e.is_playing=function(){return n}}}(window);