function toggleFullScreen(){document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement?document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen():document.documentElement.requestFullscreen?document.documentElement.requestFullscreen():document.documentElement.msRequestFullscreen?document.documentElement.msRequestFullscreen():document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():document.documentElement.webkitRequestFullscreen&&document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)}function fetch(a){var c=$.cookie(a),d=window.localStorage.getItem(a);return c||d?c||d:null}function store(a,b){$.cookie(a,b,{expires:365}),window.localStorage.setItem(a,b)}function achievement(){msg_icon.removeClass().addClass("icon-trophy"),msg.fadeIn(),setTimeout(function(){msg.fadeOut()},1500)}function goDash(){var a=ROUNDS_TO_HIDE;a+=~~(20*Math.random()),game.prepare(challenges,konami?42:1,BEST_SCORE,-1),tic=(new Date).getTime(),game.start()}var W,H,SITE=escape("http://dash.breno.io/"),listener=new window.keypress.Listener,msg=null,msg_icon=null,game=null,end_game_view=null,last_score=null,last_time=null,konami=!1,best=0,BEST_SCORE=0,tic=0,shares={fb:null,tw:null},ROUNDS_TO_HIDE=-1,tutorial=1,message=null,tutorial_btn={on:null,off:null},taught=[],challenges=[{alias:"simple",morph:function(a){return{expected:[a.expected[0]]}},text:"Press the key/swipe to the direction of the arrow"},{alias:"reverse",constraints:["pressed","previous"],rounds:15,morph:function(a){for(var c=a.expected.length,d={expected:[]},e=0;c>e;e++)d.expected.push(mod(a.expected[e]+2,4));return d},text:"Press the key/swipe to the opposite direction of the arrow"},{alias:"double",constraints:["pressed","previous"],rounds:10,morph:function(a){return{expected:[a.expected[0],a.expected[0]]}},text:"Press the key/swipe twice to the direction of the arrow"},{alias:"previous",first_turn:!1,constraints:["reverse","double","pressed"],rounds:25,morph:function(a,b){return{expected:b.expected,missable:b.missable,direction:b.direction}},text:"Repeat your previous action"},{alias:"pressed",constraints:["reverse","double","pressed"],rounds:30,morph:function(){return{expected:[],missable:!1}},text:"Do not do anything!"}];listener.sequence_combo("up up down down left right left right b a enter",function(){konami^=!0,msg_icon.removeClass().addClass("icon-joystick"),msg.fadeIn(),setTimeout(function(){msg.fadeOut()},1500)}),listener.sequence_combo("esc",function(){game.is_playing()&&(game.end(),message.fadeOut("fast"))}),$(document).ready(function(){$("#btn_howto").click(function(){$("#info").fadeIn("slow",function(){$(this).css("overflow","auto")})}),$("#btn_full").click(toggleFullScreen),$(".dismiss").click(function(){$(this).parent().fadeOut()}),W=$(window).width(),H=$(window).height(),msg=$("#msg"),msg_icon=$("#msg_icon"),end_game_view=$("#end_game_view"),best=$("#best"),last_score=$("#last_score"),last_time=$("#last_time"),shares.tw=$("#tw_share_score"),message=$("#tutorial"),tutorial_btn={on:$("#tutorial_on"),off:$("#tutorial_off")},null===fetch("best")&&store("best",0),null===fetch("tutorial")&&store("tutorial",challenges.length),BEST_SCORE=fetch("best"),tutorial=parseInt(fetch("tutorial")),0!==tutorial&&(tutorial_btn.on.toggle(),tutorial_btn.off.toggle()),best.html(BEST_SCORE),tutorial_btn.on.click(function(){tutorial=challenges.length,store("tutorial",tutorial),tutorial_btn.on.toggle(),tutorial_btn.off.toggle()}),tutorial_btn.off.click(function(){tutorial=0,store("tutorial",tutorial),tutorial_btn.on.toggle(),tutorial_btn.off.toggle()}),Interface=new DashGUI({panels:["#panel-0","#panel-1"],icons:["#panel-0 i","#panel-1 i"],score:{main:"#score",timer:"#gauge",lives:".lives div",points:"#counter"}},{base_index:1e3,presets:8,panel:"preset-*",icon:"icon-angle-.",wrong_icon:"icon-cancel",life_lost:"+lost",correct_icon:"+correct",replace_array:["left","up","right","down"],timer_color:"bg-*"},{1:{panel:"reverse-*"},2:{icon:"icon-angle-double-."},3:{icon:"icon-cw"},4:{icon:"+pressed"}});var a={on_panel_retrieve:function(a,b,c){var d=b[0];0===tutorial||taught.has(d)||(game.pause(),message.html(challenges[d].text),message.fadeIn("fast"),0===c.length&&setTimeout(function(){message.fadeOut("fast"),game.resume(),game.correct()},2e3),taught.push(d)===challenges.length&&(store("tutorial",0),tutorial_btn.on.toggle(),tutorial_btn.off.toggle()))},after_game:function(a){var b=(new Date).getTime(),c=~~((b-tic)/1e3);last_time.html(c),last_score.html(a);var d="I've made "+a+" points in Dash! Can you dash faster? #Dash";d=escape(d),shares.tw.click(function(){Clay("client.share.any",{text:unescape(d)})}),_gaq.push(["_setCustomVar",1,"Section","Score",a]),_gaq.push(["_setCustomVar",2,"Section","Time",c]),end_game_view.fadeIn("slow",function(){$(this).css("overflow","auto")}),a>BEST_SCORE&&(store("best",a),BEST_SCORE=a,best.html(BEST_SCORE))},best_score:function(){achievement()},lost_life:function(){},got_point:function(){},key_pressed:function(a){0!==tutorial&&game.is_paused()&&game.test(a)&&(tutorial--,game.resume(),setTimeout(function(){message.fadeOut("slow")},1e3),game.correct())}};game=new Dash(Interface,a,{press_time:1800,step:6}).init(),$("#btn_play").click(function(){goDash()}),$("#btn_again").click(function(){goDash(),end_game_view.fadeOut()})});