!function(a){"use strict";a.DashLevel=function(a,b,c){if(!a)return!1;for(var d=a.length,e=4,f=sec2ms(2),g=sec2ms(.04),h=sec2ms(.7),i=0;d>i;i++){var j=a[i];void 0!==j.morph?(void 0===j.missable&&(j.missable=!0),void 0===j.first_turn&&(j.first_turn=!0),void 0===j.rounds&&(j.rounds=0),void 0===j.constraints&&(j.constraints=[])):a[i]=null}for(var k=[],i=0;d>i;i++){var j=a[i];if(null!==j){var l={index:i,rounds:j.rounds};k.push(l)}}for(var m={},i=0;d>i;i++){var j=a[i],n=i;void 0!==j.alias&&(n=j.alias),m[n]=i}if(0===k.length)return!1;k.sort(function(a,b){return a.rounds-b.rounds}),void 0===c&&(c=1),void 0===b&&(b={}),void 0===b.press_time&&(b.press_time=f),void 0===b.step&&(b.step=g),void 0===b.minimun_velocity&&(b.minimun_velocity=h);var o=this;o.expected=null;var p={expected:null,missable:null};o.challenges=null,o.raw=null,o.press_time=b.press_time,o.missable=!0;var q=-1;o.allowed=[];var r=function(a){return~~(Math.random()*a)},s=function(){if(0!==k.length){var a=k[0];a.rounds===q&&(o.allowed.push(a.index),k.shift(),s())}},t=function(){var a=r(e),b={expected:[a],challenges:[],missable:!0};o.raw=a;for(var d=0;c>d;d++)b=u(b);o.expected=b.expected,o.challenges=b.challenges,o.missable=b.missable,p={expected:o.expected,missable:o.missable}},u=function(b){b.expected;for(var g,h,e=b.challenges.length,i=null;;)if(h=r(d),g=a[h],(0!==q||g.first_turn)&&o.allowed.has(h)){for(var j=0;e>j;j++){var k=b.challenges[j];!k.constraints.has(m[h])}if(i=g.morph(b,p),p.missable!==!1||i.missable!==!1)break}return b.challenges.push(h),void 0===i.missable&&(i.missable=!0),{expected:i.expected,challenges:b.challenges,missable:i.missable}};o.new_round=function(){q++,s(),t(),o.press_time-=b.step,o.press_time=Math.max(o.press_time,b.minimun_velocity)},o.get_rounds=function(){return q}}}(window);